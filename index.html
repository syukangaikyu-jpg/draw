<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>é€±åˆŠé§çƒ WEEK50 æŠ½é¸</title>
</head>
<body style="font-family:sans-serif; text-align:center; padding:50px;">
  <h1>WEEK50<br>è¨˜å¿µæŠ½é¸</h1>
  <p>ã€ŒæŠ½é¸ã™ã‚‹ã€ã‚’æŠ¼ã™ã¨å½“è½ãŒå‡ºã¾ã™ã€‚<br>å½“ãŸã‚Šã¯5åé™å®šï¼</p>
  <button onclick="draw()">æŠ½é¸ã™ã‚‹</button>
  <div id="result" style="margin-top:20px; font-size:18px;"></div>

<script>
  // ã“ã“ã«ã‚ã¨ã§Google Apps Scriptã®URLã‚’å…¥ã‚Œã¾ã™
  const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzATnE64sDfTqsZruBA1RoDFh3fRzogZaozg5juIlrfApDOH_55_zn3kJX6YyAx63M8Sw/exec";
const KEY = "sg_week50_draw_done"; // ã“ã®ç«¯æœ«ã§æŠ½é¸ã—ãŸã‹ã©ã†ã‹è¨˜éŒ²ã™ã‚‹ã‚­ãƒ¼

async function draw() {
  // ã™ã§ã«æŠ½é¸æ¸ˆã¿ãªã‚‰å†æŒ‘æˆ¦ä¸å¯
  if (localStorage.getItem(KEY)) {
    document.getElementById("result").innerHTML =
      "âš ï¸ ã“ã®ç«¯æœ«ã§ã¯æŠ½é¸ã¯1å›ã¾ã§ã§ã™ã€‚";
    return;
  }

  try {
    let res = await fetch(WEB_APP_URL);
    let data = await res.json();

    if (data.result === "win") {
      document.getElementById("result").innerHTML =
        "ğŸ‰ å½“é¸ï¼ã“ã¡ã‚‰ã‹ã‚‰ä½æ‰€ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ ğŸ‘‰ " +
        "<a href='https://docs.google.com/forms/d/https://forms.gle/i2LQe7MFNzf55JfV9/viewform' target='_blank'>å½“é¸è€…ãƒ•ã‚©ãƒ¼ãƒ </a>";
      localStorage.setItem(KEY, "win"); // æŠ½é¸æ¸ˆã¿ãƒ•ãƒ©ã‚°ã‚’ä¿å­˜
    } else {
      document.getElementById("result").innerHTML = "ğŸ˜¢ ãƒã‚ºãƒ¬â€¦ã¾ãŸæŒ‘æˆ¦ã—ã¦ã­ï¼";
      localStorage.setItem(KEY, "lose"); // æŠ½é¸æ¸ˆã¿ãƒ•ãƒ©ã‚°ã‚’ä¿å­˜
    }
  } catch (e) {
    document.getElementById("result").innerHTML = "é€šä¿¡ã‚¨ãƒ©ãƒ¼ï¼šè¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚";
  }
}
</script>
</body>
</html>
